{% extends 'base.html' %}

{% load static %}
{% load crispy_forms_tags %}

{% block extracss %}
<link href="{% static 'airdatepicker/datepicker.min.css' %}" rel="stylesheet" type="text/css">
{% endblock %}

{% block content %}
{% include 'classroom/_header.html' with active='attendance' %}
<!-- <form>
  <div class="form-row">
    <div class="form-group col-md-4">
      <label>Classroom</label>
      <select class="form-control">
        <option selected>Choose...</option>
        <option>...</option>
      </select>
  	</div>

    <div class="form-group col-md-4">
      <label>Date</label>
      <input type='text' id="attendancedate" class='form-control' data-language='en'/>
    </div>
    <div class="form-group col-md-4">
    	<br>
    	<button type="submit" class="btn btn-primary">Enter Attendance</button>
    </div>
  </div>
</form> -->

<form class="form-inline">
  <div class="form-group mb-2">
    <label class="sr-only">Classroom</label>
    <select class="form-control form-control-sm" name="classroom">
        <option value="">Select Class</option>
        {% for classroom in classrooms %}
        	<option value="{{ classroom.pk }}"{% if classroom.pk == att_classroom %} selected{% endif %}>{{ classroom.name }}</option>
        {% endfor %}
    </select>
  </div>
  <div class="form-group mx-sm-3 mb-2">
    <label class="sr-only">Date</label>
    <input name="date" type='text' id="attendancedate" placeholder="Date" class='form-control form-control-sm' data-language='en' autocomplete="off" value="{{att_date}}" />
  </div>
  <button type="submit" class="btn btn-sm btn-primary mb-2">Enter Attendance</button>
</form>
<hr>
{% if students %}
<form action="{% url 'classroom:attendance' %}" method="post"> {% csrf_token %}
<div class="table-responsive">
  <input type="hidden" name="classroom" value="{{att_classroom}}">
  <input type="hidden" name="date" value="{{att_date}}">
  <table class="table">
    <!-- <thead>
      <tr>
          <th>Student name</th>
          <th></th>
      </tr>
    </thead> -->
      <tbody>
      {% for s in students %}
          <tr>
          <td>{{s.user.get_full_name|default:s.user.username}}</td>
          <td>
            <div class="btn-group btn-group-toggle" data-toggle="buttons">
              <label class="btn btn-sm btn-outline-success active">
                  <input type="radio" name="{{ s.user_id }}" value="P" checked> Present
              </label>
              <label class="btn btn-sm btn-outline-danger">
                  <input type="radio" name="{{ s.user_id }}" value="A"> Absent
              </label>
            </div>
          </td>
          </tr>
      {% endfor %}
        <tr><td colspan="2"><input class="btn btn-success pull-right" type="submit" value="Save"></td></tr>
      </tbody>
  </table>
</div>

</form>
{% endif %}

{% endblock %}

{% block extrajs %}
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<script src="{% static 'airdatepicker/datepicker.min.js' %}"></script>
<script src="{% static 'airdatepicker/datepicker.en.js' %}"></script>
<script type="text/javascript">
	$(document).ready(function () {
		$('#attendancedate').datepicker({
	        dateFormat: "dd/mm/yyyy",
	        autoClose: true,
	        onRenderCell: function (date, cellType) {
		        if (cellType == 'day') {
		            var day = date.getDay(),
		                isDisabled = [0, 6].indexOf(day) != -1;
		            return {
		                disabled: isDisabled
		            }
		        }
		    }
    	});
    });
</script>
{% endblock %}